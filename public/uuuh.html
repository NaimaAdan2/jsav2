<!DOCTYPE html>
<html>
  <head>
    <title>sort</title>
    <h1> lol </h1>
    <link rel="stylesheet" href="../css/JSAV.css" type="text/css" media="screen" title="no title" charset="utf-8" />
    <style>
    #container {
      width: 100%;
      position: relative;
    }
    .jsavcounter {
      position: absolute;
      top: 15px;
    }
    .jsavcanvas { height: 150px; }
    </style>
  </head>
  <body>
      <div id="container">
          <div class="jsavcontrols"></div><span class="jsavcounter"></span>
          <p class="jsavoutput jsavline"></p>
          <div class="jsavcanvas"></div>
          <input id="userInput"></input>
          <button id="run"> run </button>
          <button id="reset"> reset </button>
      </div>
  </div>
  <style>
  </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script src="../lib/jquery.transit.js"></script>
    <script src="../lib/raphael.js"></script>
    <script src="../build/JSAV.js"></script>
    <script>

// this is for the run button 
  function run(){
    let runButton = document.getElementById("run")

    runButton.addEventListener("click", function() {
        let input = document.getElementById("userInput")
        let str = input.value;
        let arr = str.split(",");
        jsavFunction(arr);
        document.getElementById("run").disabled = true;
    })
      
     }
        function reset() {
            let resetButton = document.getElementById("reset")

            resetButton.addEventListener("click", function () {

                location.reload();

            })
        }
      

// bubble sort with code 
  function jsavFunction(theArray, ){
      console.log(theArray);
      console.log(j);
    var jsav = new JSAV("container");
    var arr = jsav.ds.array(theArray);
    var codeArr = [
        "for (i = 0; i < arr.size() - 1; i++) {",
        "   for (j = 1; j < arr.size() - i; j++) {",
        "       if (arr.value(j - 1) > arr.value(j)) {",
        "           arr.swap(j - 1, j);",
        "       }",
        "   }",
        "}",
    ]
  
    var code = jsav.code(codeArr)
    var i, j;
      var arrayPointer = jsav.pointer("pointer", arr ,{
          targetIndex: 0,
         // arr.index
         // visible: true,
        //  anchor: "center bottom",
        //  myAnchor: "right top",
        //   top: 10,
        //    left: -20,
        // arrowAnchor: "center bottom"
      });
    console.log(j);
    arr.highlight(0);
    jsav.umsg("For each pass, we will move left to right swapping adjacent elements as needed. Each pass moves the next largest element into its final position (these will be shown in lighter color).");
      arrayPointer.css({ "color": "yellow" });
      //arrayPointer.addClass("mypointer");
     
      jsav.step();
      //arrayPointer.target(arr, { targetIndex: i });
    for (i = 0; i < arr.size() - 1; i++) {
        jsav.umsg("Starting pass " + i);
        

        //sets the line at given index as the current line
        code.setCurrentLine(1);
        jsav.step();
       // arrayPointer.target(arr, { targetIndex: i }); 
        //jsav.recorded();
        jsav.umsg("For each element moving through the list");
       
        code.setCurrentLine(2);
        jsav.step();
       
      //  arrayPointer.target(arr, { targetIndex: i }); 
        for (j = 1; j < arr.size() - i; j++) {
            
            
            console.log(j);
             //sets the line at given index as the current line
            code.setCurrentLine(3);
            
            // highlight codelines at give indes
            
            arr.highlight(j);
            
            arrayPointer.target(arr, { targetIndex: j });
            jsav.umsg("Compare elements");
           
            jsav.step();
           arrayPointer.target(arr, { targetIndex: j});

            if (arr.value(j - 1) > arr.value(j)) {
                //arrayPointer.target(arr);
               
                jsav.umsg("Swap");
                code.setCurrentLine(4);
               
                //Swaps the values of the two array positions

                
                arr.swap(j - 1, j);
                jsav.step();
               arrayPointer.target(arr, { targetIndex: j-1 });
            }
            arr.unhighlight(j - 1);
            arrayPointer.target(arr, { targetIndex: j});
        }
        arr.unhighlight(j - 1);
        arrayPointer.target(arr, { targetIndex: j - 1 });
        jsav.umsg("Done this pass");
        jsav.step();
        arrayPointer.target(arr, { targetIndex: j - 1 });
       
       // arrayPointer.hide(j);
    }
    jsav.umsg("It is done sorting!");
    arrayPointer.hide(j);
    jsav.step();
    jsav.recorded();
    console.log(j);
};
      
//
// this executed the "run" button
            run();
        reset();
    </script>
  </body>
</html>
